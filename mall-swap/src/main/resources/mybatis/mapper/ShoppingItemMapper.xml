<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.yyf.mallcache.mapper.ShoppingItemMapper" >
  <resultMap id="BaseResultMap" type="com.yyf.mallcache.bean.ShoppingItem" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Jul 30 09:42:32 CST 2019.
    -->
    <id column="item_id" property="itemId" jdbcType="INTEGER" />
    <result column="product_id" property="productId" jdbcType="INTEGER" />
    <result column="product_amount" property="productAmount" jdbcType="INTEGER" />
    <result column="item_price" property="itemPrice" jdbcType="DECIMAL" />
    <result column="user_id" property="userId" jdbcType="INTEGER" />
    <association property="product" fetchType="eager"
    select="com.yyf.mallcache.mapper.ProductMapper.getCartProductByPrimaryKey" column="product_id"></association>
  </resultMap>
  
  <!--  int deleteByUserId(Integer userId); -->
  <delete id="deleteByUserId" parameterType="java.lang.Integer" >
    delete from shopping_item
    where user_id = #{userId}
  </delete>
  
  <!-- int deleteByUserIdAndProductIdy(@Param("productId") Integer productId,@Param("userId") Integer userId); -->
  <delete id="deleteByUserIdAndProductIdy" parameterType="java.lang.Integer">
    delete from shopping_item
     where user_id = #{userId} and product_id=#{productId}
  </delete>
  
  <insert id="insert" parameterType="com.yyf.mallcache.bean.ShoppingItem" useGeneratedKeys="true" keyProperty="itemId" >
    insert into shopping_item ( product_id, product_amount, 
      item_price, user_id)
    values ( #{productId}, #{productAmount},  #{itemPrice}, #{userId})
  </insert>
  
  <!-- int updateByUserIdAndProductId(ShoppingItem record); -->
  <update id="updateByUserIdAndProductId" parameterType="com.yyf.mallcache.bean.ShoppingItem" >
    update shopping_item
    set 
      product_amount = #{productAmount},
      item_price = #{itemPrice}
    where user_id = #{userId} and product_id=#{productId}
  </update>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
 
    select item_id, product_id, product_amount, item_price, user_id
    from shopping_item
    where item_id = #{itemId,jdbcType=INTEGER}
  </select>
  
  <select id="selectAll" resultMap="BaseResultMap" >
    select item_id, product_id, product_amount, item_price, user_id
    from shopping_item
  </select>
  <!-- List<ShoppingItem> selectByUserId(Integer usetId); -->
  <select id="selectByUserId" resultMap="BaseResultMap">
  SELECT item_id,product_id,product_amount,item_price FROM shopping_item WHERE user_id=#{userId}
  </select>
  
  <!-- ShoppingItem selectByUserIdAndProductId(@Param("productId") Integer productId,@Param("userId") Integer userId); -->
    <select id="selectByUserIdAndProductId"  resultType="Integer">
    select product_amount from shopping_item WHERE user_id=#{userId} and product_id=#{productId}
    </select>
    
    <!--  ShoppingItem getItemByProductIdAndUserId(@Param("productId") Integer productId,@Param("userId") Integer userId); -->
        <select id="getItemByProductIdAndUserId"  resultMap="BaseResultMap">
    select item_id, product_id, product_amount, item_price, user_id from shopping_item WHERE user_id=#{userId} and product_id=#{productId}
    </select>
</mapper>