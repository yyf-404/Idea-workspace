<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.yyf.mallcache.mapper.SecProductMapper" >
  <resultMap id="BaseResultMap" type="com.yyf.mallcache.bean.SecProduct" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Aug 18 18:55:30 CST 2019.
    -->
    <id column="secproduct_id" property="secproductId" jdbcType="INTEGER" />
    <result column="sec_price" property="secPrice" jdbcType="DECIMAL" />
    <result column="sec_storeNumber" property="secStorenumber" jdbcType="INTEGER" />
    <result column="sec_salesAmount" property="secSalesamount" jdbcType="INTEGER" />
    <result column="start_date" property="startDate" jdbcType="TIMESTAMP" />
    <result column="end_date" property="endDate" jdbcType="TIMESTAMP" />
    <association property="product" select="com.yyf.mallcache.mapper.ProductMapper.selectByPrimaryKey"
			column="product_id" fetchType="eager">
</association>
  </resultMap>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Aug 18 18:55:30 CST 2019.
    -->
    delete from sec_product
    where secproduct_id = #{secproductId,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.yyf.mallcache.bean.SecProduct" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Aug 18 18:55:30 CST 2019.
    -->
    insert into sec_product (secproduct_id, product_id, sec_price, 
      sec_storeNumber, sec_salesAmount, start_date, 
      end_date)
    values (#{secproductId,jdbcType=INTEGER}, #{productId,jdbcType=INTEGER}, #{secPrice,jdbcType=DECIMAL}, 
      #{secStorenumber,jdbcType=INTEGER}, #{secSalesamount,jdbcType=INTEGER}, #{startDate,jdbcType=TIMESTAMP}, 
      #{endDate,jdbcType=TIMESTAMP})
  </insert>
  
  <update id="updateByPrimaryKey" parameterType="com.yyf.mallcache.bean.SecProduct" >
    update sec_product
    set product_id = #{productId,jdbcType=INTEGER},
      sec_price = #{secPrice,jdbcType=DECIMAL},
      sec_storeNumber = #{secStorenumber,jdbcType=INTEGER},
      sec_salesAmount = #{secSalesamount,jdbcType=INTEGER},
      start_date = #{startDate,jdbcType=TIMESTAMP},
      end_date = #{endDate,jdbcType=TIMESTAMP}
    where secproduct_id = #{secproductId,jdbcType=INTEGER}
  </update>
  
  <!-- int updateStoreNumberAndSaleAmountById(Integer secproductId); -->
    <update id="updateStoreNumberAndSaleAmountById" parameterType="Integer"  >
    update sec_product
    set 
      sec_storeNumber =  sec_storeNumber-1,
      sec_salesAmount = sec_salesAmount+1
    where secproduct_id = #{secproductId} and  sec_storeNumber >0
  </update>
  
  <!--  SecProduct selectByProductId(Integer productId); -->
  <select id="selectByProductId" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    select secproduct_id, product_id, sec_price, sec_storeNumber, sec_salesAmount, start_date, 
    end_date
    from sec_product
    where product_id = #{productId}
  </select>
  <!-- SecProduct selectByPrimaryKey(Integer secproductId); -->
   <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    select secproduct_id, product_id, sec_price, sec_storeNumber, sec_salesAmount, start_date, 
    end_date
    from sec_product
    where secproduct_id = #{secproductId}
  </select>
  
  <select id="selectAll" resultMap="BaseResultMap" >
    select secproduct_id, product_id, sec_price, sec_storeNumber, sec_salesAmount, start_date, 
    end_date
    from sec_product
  </select>
  
  <!-- Integer selectStoreNumberById(Integer secproductId); -->
    <select id="selectStoreNumberById" resultType="java.lang.Integer" >
    select  sec_storeNumber from sec_product 
    where secproduct_id=#{secproductId}
  </select>
</mapper>