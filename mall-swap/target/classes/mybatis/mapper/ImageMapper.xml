<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.yyf.mallcache.mapper.ImageMapper" >
    <resultMap id="BaseResultMap" type="com.yyf.mallcache.bean.Image" >
        <id column="image_id" property="imageId" jdbcType="INTEGER" />
        <result column="image_name" property="imageName" jdbcType="VARCHAR" />
        <result column="image_path" property="imagePath" jdbcType="VARCHAR" />
    </resultMap>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >

    delete from mall_image
    where image_id = #{imageId,jdbcType=INTEGER}
  </delete>

    <insert id="insert" parameterType="com.yyf.mallcache.bean.Image"
            useGeneratedKeys="true" keyProperty="imageId">
    insert into mall_image ( image_name, image_path )
    values ( #{imageName}, #{imagePath})
  </insert>

    <update id="updateByPrimaryKey" parameterType="com.yyf.mallcache.bean.Image" >
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Sat Jul 27 15:21:00 CST 2019.
        -->
        update mall_image
        set image_name = #{imageName,jdbcType=VARCHAR},
        image_path = #{imagePath,jdbcType=VARCHAR}
        where image_id = #{imageId,jdbcType=INTEGER}
    </update>
    <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Sat Jul 27 15:21:00 CST 2019.
        -->
        select image_id, image_name, image_path
        from mall_image
        where image_id = #{imageId,jdbcType=INTEGER}
    </select>
    <select id="selectAll" resultMap="BaseResultMap" >
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Sat Jul 27 15:21:00 CST 2019.
        -->
        select image_id, image_name, image_path
        from mall_image
    </select>

    <!--  Image selectByProductIdGetSearchImage(); -->
    <select id="selectByProductIdGetSearchImage" resultMap="BaseResultMap" >
 SELECT image_id, image_name, image_path FROM mall_image WHERE image_id=
 (SELECT image_id FROM product_image WHERE IMAGE_KIND='SEARCH' AND PRODUCT_ID=#{productId} )
  </select>


    <!-- List<Image> selectByProductIdGetKindImage(Integer productId,String imageKind); -->
    <select id="selectByProductIdGetKindImage" resultMap="BaseResultMap" >
 SELECT p.image_id, image_name, image_path FROM mall_image m JOIN product_image p ON  p.image_id=m.image_id  WHERE
 IMAGE_KIND=#{imageKind} AND PRODUCT_ID=#{productId} ORDER BY image_order
  </select>

    <!--  Image selectByProductIdGetCartImage(Integer productId); -->
    <select id="selectByProductIdGetCartImage" resultMap="BaseResultMap" >
 SELECT image_id, image_name, image_path FROM mall_image WHERE image_id=
 (SELECT image_id FROM product_image WHERE IMAGE_KIND='cart' AND PRODUCT_ID=#{productId} )
  </select>
</mapper>